import math  import pandas as pdimport json#One out of K encodingdef KEncode(df, column, key, limit):    items = pd.get_dummies(pd.Series(df[column].apply(json.loads).map(lambda x:[i[key] for i in x]).apply(pd.Series).stack()))    mask = items.sum().reset_index().nlargest(limit,0)['index']    k = len(items[mask].columns)    return df.drop(column, axis=1).join(            items                .filter(items=mask)                .sum(level=0)                .fillna(0)                .add_prefix(column + '_') # * 1/math.sqrt(k)           )